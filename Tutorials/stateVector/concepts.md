---
layout: simple_layout
title: State Vector Concepts
---

# State Vectors

A fundamental concept in ensemble data assimilation is that of the state vector. In brief, a state vector is a collection of state variables and parameters describing the climate. As a rule of thumb, the elements of a state vector are the climate variables and parameters you are interested in reconstructing. These values are often generated by a climate model, but can also include data from other sources. For example, some paleoclimate assimilation have used state vectors that include real-world proxy records (for the purpose of reconstruction verification). Whatever the application, a state vector can include multiple variables with different spatial and temporal resolutions. For example, I could make a state vector consisting of monthly gridded surface temperatures and precipitation, and annual-mean, spatial-mean temperature in the Northern Hemisphere.

INSERT FIGURE HERE. (Illustration of the state vector)

Within the DASH framework, different variables are defined as either
1. Describing a different climate variable, or
2. Having different spatial or temporal resolution.

For example, a gridded monthly temperature field and gridded monthly precipitation field are different variables because they describe different climate parameters. Monthly precipitation and annual precipitation would be different variables because they have different temporal resolution, and gridded temperatures and global mean temperatures are different variables because they have different spatial resolution. In my example state vector, there are 3 variables:
1. Gridded monthly temperature -- let's call it "T"
2. Gridded monthly precipitation -- I'll call it "P"
3. Annual, global mean temperature -- we'll use "Tmean"

INSERT FIGURE (State vector with variable abbreviations)

# Ensembles

A second important concept is that of the state vector ensemble. This is a collection of multiple iterations of a state vector, and is typically used to estimate climate system covariance and as the prior for an assimilation. In paleoclimate, ensemble members (different iterations of the state vector) are typically selected from different time slices and/or ensemble members of climate model output. Continuing the previous example, a small ensemble for my state vector might look like Figure 3.

INSERT FIGURE HERE.

Here, each column is a different ensemble member. Each ensemble member has the T, P, and Tmean variables, but in a different time slice. In the case of ensemble member 5, the ensemble member is from the same time step as ensemble member 1, but from a different simulation.

# State and Ensemble Dimensions

Throughout the stateVector tutorial, we will refer to "state dimensions" and "ensemble dimensions". These dimensions are the different dimensions of a variable (such as latitude, longitude, time, etc). The state or ensemble modifier indicates whether the metadata for the dimension is defined along the state vector or along the ensemble members. If the metadata for a dimension is constant along a row of an ensemble, then it is a state dimension. If the dimension's metadata is constant along a column of the ensemble, then it is an ensemble dimension. Let's zoom in on the "T" variable from my ensemble as an example.

INSERT FIGURE HERE

Here, we can see that each row is associated with a unique spatial coordinate because each element in the state vector holds the data for a particular grid point. The latitude-longitude coordinate within each row is constant; for example, row 5 always describes the grid point at (X, Y) regardless of which ensemble member is selected. Thus, latitude and longitude are state dimensions. By contrast, each column is associated with a constant time and run coordinate. For example, column 5 always refers to data from year 1 in run 2, regardless of the spatial point. Thus, time and run are ensemble dimensions in this case. As a rule of thumb, the "lat","lon","coord","lev", and "var" dimensions are often state dimensions, and the "time" and "run" dimensions are often ensemble dimensions. However, this is just a rule of thumb and not a strict requirement; depending on your applications, any dimension could be a state dimension or ensemble dimension.

# Sequences

Sometimes, you may want an ensemble dimension to have some additional structure down the state vector, which this tutorial will refer to as a "sequence". Sequences most commonly occur when including multiple, sequential time steps in a state vector.

For example, let's say I want my "T" variable to include the spatial grid from June, July, and August in a given year. The state vector ensemble for this variable would have the following structure.

INSERT FIGURE HERE

We can see that the ensemble dimension "time" now has metadata along both the state vector and the ensemble. The columns still refer to a unique (time, run) coordinate, but the rows also refer to a particular month. This additional metadata along the state vector forms a sequence for the time dimension. Note that time is still an ensemble dimension because metadata along the ensemble is still required to form a unique time coordinate. For example, we know an element in row 5 is from June, but we don't know the year until referencing a specific ensemble member.

Alright, that's it for concepts. Let's start designing a state vector!
[Previous](intro)   [Next](new)
